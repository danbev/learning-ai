### CUDA examples


### ptx and sass syntax highlighting
Add the following to .vimrc:
```
au BufNewFile,BufRead *.ptx  set filetype=ptx
au BufNewFile,BufRead *.sass set filetype=sasscuda
```
And then copy the two file in .vim/syntax to `~/.vim/syntax/`.

### ldmatrix 
So we have the following 16x16 matrix in shared memory and in flash attention
these would be the scaled Q values in half precision/fp16.
```console
   0  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
0 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
1 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
2 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
3 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
4 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
5 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
6 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
7 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
8 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
9 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
10|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
11|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
12|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
13|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
14|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
15|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

Total elements: 256 (16x16)
Total size    : 512 bytes (256 elements x 2 bytes/element for FP16)
```
If we look at the ldmatrix instruction:
```
ldmatrix.sync.aligned.m8n8.x2.b16
```
The m8n8 tells us that this instruction is designed to operate on an 8x8 matrix
tile. The x2 tells us that it can load two such tiles in a single instruction.
And the b16 indicates that each element in the matrix is 16 bits (2 bytes).

The warp will load the left half of the 16x16 matrix, which is 16x8=128 elements.
And we have 32 threads in a warp so each thread will load 4 elements (128/32).
```console
   0  1  2  3  4  5  6  7  
  +--+--+--+--+--+--+--+--+
0 |T1|T1|T1|T1|T2|T2|T2|T2|
  +--+--+--+--+--+--+--+--+
1 |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
2 |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
3 |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
4 |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
5 |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
6 |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
7 |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
8 |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
9 |  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
10|  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
11|  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
12|  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
13|  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
14|  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
15|  |  |  |  |  |  |  |  |
  +--+--+--+--+--+--+--+--+
```
And the next ldmatrix will handle the second half.
